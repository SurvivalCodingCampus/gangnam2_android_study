# 2025-12-10 TIL

## UI State Holder 패턴

### UI 상태의 종류
- 화면 상태 (Screen UI State)
  - 화면에 보여주기 위한 데이터
  - ViewModel 이 관리
- 위젯 자체 상태 (UI Element State)
  - 버튼이 눌렸는지, 체크박스가 켜졌는지 같은 상태
  - remember() 로 관리

### 상태는 고정된 값이 아니다.
- 상태는 시간이나 사용자 행동에 따라 계속 바뀐다.
- 예: 검색창에 글자를 입력하면 검색 결과가 달라짐
- 이러한 변화는 ViewModel이 관리한다. -> ViewModel이 상태를 바꾸면 UI도 자동으로 다시 그린다.

### UI 상태 홀더
- ViewModel 이 복잡해짐 -> 인간의 실수 확률 증가
- 개선 방법 -> UI 상태를 담는 Wrapper 클래스 단일 상태 객체인 UI 상태 홀더를 만들자
- 불변 객체라 값을 변경해야 할 때는 copy()로 복사
- 변수가 1개라 인간의 실수 확률도 줄어든다.

### 상태 변경시 copy() 사용
- 상태를 변경할 때는 copy() 사용
- 원래 상태는 그대로 두고, 일부만 바꾼 새로운 상태를 만든다.

### update()
- update : 비동기에서 안전하게 복사 → 매직
- Thread-safe
- 동시성 문제 방지
- 특히 코루틴이나 다중 스레드 환경에서 중요!


### UI 상태 홀더의 장점
- 코드가 더 간결하고 보기 쉬워진다.
- 테스트가 쉬움
- 유지보수 편해짐
- 실수할 가능성이 줄어든다

### Android 생명 주기 대응
```kotlin
val state by viewModel.state.collectAsStateWithLifecycle()
```
- 라이프사이클 인식
- Started 상태에서만 수집
- 백그라운드에서 수집 중지
- 안드로이드에서는 이걸 사용하는 거 추천~

